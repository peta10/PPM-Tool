-- WARNING: This schema is for context only and is not meant to be run.
-- Table order and constraints may not be valid for execution.

CREATE TABLE public.admin_users (
  user_id uuid,
  email text NOT NULL UNIQUE,
  role USER-DEFINED NOT NULL,
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  created_at timestamp with time zone NOT NULL DEFAULT now(),
  CONSTRAINT admin_users_pkey PRIMARY KEY (id),
  CONSTRAINT admin_users_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id)
);
CREATE TABLE public.contact_submissions (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  created_at timestamp with time zone DEFAULT now(),
  name text NOT NULL,
  email text NOT NULL,
  company text NOT NULL,
  message text NOT NULL,
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT contact_submissions_pkey PRIMARY KEY (id)
);
CREATE TABLE public.criteria (
  name text NOT NULL,
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  active_on timestamp with time zone NOT NULL DEFAULT now(),
  created_on timestamp with time zone NOT NULL DEFAULT now(),
  CONSTRAINT criteria_pkey PRIMARY KEY (id)
);
CREATE TABLE public.criteria_tools (
  tool_id uuid,
  criteria_id uuid,
  ranking integer NOT NULL CHECK (ranking >= 1 AND ranking <= 5),
  description text,
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  CONSTRAINT criteria_tools_pkey PRIMARY KEY (id),
  CONSTRAINT criteria_tools_tool_id_fkey FOREIGN KEY (tool_id) REFERENCES public.tools(id),
  CONSTRAINT criteria_tools_criteria_id_fkey FOREIGN KEY (criteria_id) REFERENCES public.criteria(id)
);
CREATE TABLE public.tag_tools (
  tool_id uuid,
  tag_id uuid,
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  CONSTRAINT tag_tools_pkey PRIMARY KEY (id),
  CONSTRAINT tag_tools_tool_id_fkey FOREIGN KEY (tool_id) REFERENCES public.tools(id),
  CONSTRAINT tag_tools_tag_id_fkey FOREIGN KEY (tag_id) REFERENCES public.tags(id)
);
CREATE TABLE public.tag_type (
  name text NOT NULL,
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  created_on timestamp with time zone NOT NULL DEFAULT now(),
  CONSTRAINT tag_type_pkey PRIMARY KEY (id)
);
CREATE TABLE public.tags (
  name text NOT NULL,
  tag_type_id uuid,
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  created_on timestamp with time zone NOT NULL DEFAULT now(),
  CONSTRAINT tags_pkey PRIMARY KEY (id),
  CONSTRAINT tags_tag_type_id_fkey FOREIGN KEY (tag_type_id) REFERENCES public.tag_type(id)
);
CREATE TABLE public.tools (
  name text NOT NULL,
  type USER-DEFINED NOT NULL,
  created_by uuid,
  submitted_at timestamp with time zone,
  approved_at timestamp with time zone,
  updated_at timestamp with time zone,
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  created_on timestamp with time zone NOT NULL DEFAULT now(),
  submission_status USER-DEFINED DEFAULT 'draft'::submission_status,
  CONSTRAINT tools_pkey PRIMARY KEY (id),
  CONSTRAINT tools_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id)
);
CREATE TABLE public.user_criteria (
  user_id uuid,
  criteria_id uuid,
  ranking integer NOT NULL CHECK (ranking >= 1 AND ranking <= 5),
  deleted_at timestamp with time zone,
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  CONSTRAINT user_criteria_pkey PRIMARY KEY (id),
  CONSTRAINT user_criteria_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id),
  CONSTRAINT user_criteria_criteria_id_fkey FOREIGN KEY (criteria_id) REFERENCES public.criteria(id)
);